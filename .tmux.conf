#utf setting - 船越さんから頂いた
#######
# tmux 設定の書き方
#  - bind -n でプレフィックスを使わないキーバインドを設定できる
#######
set-window-option -g utf8 on
set-window-option -g mode-keys vi
set-window-option -g automatic-rename off
set-option -g base-index 1
#set-option -g mouse-select-window on
#set-option -g mouse-select-pane on
#set-option -g mode-mouse on
#set-option -g mouse-resize-pane on
set -g terminal-overrides 'xterm*:smcup@:rmcup@'


# set -g status-bg white
# set -g status-fg black

set -s escape-time 0
setw -g window-status-current-attr underscore

# 256色ターミナル
set-option -g default-terminal "screen-256color"
# set-option -g default-terminal "putty-256color" # ファイルを閉じるとプロンプトがコンソール最下層に行くバグ発生

## ステータスラインカスタム関連
set -g status-bg black
set -g status-fg white
set -g status-attr dim
## 左部:whoami@hostname
set -g status-left '#[fg=blue,bold][#20(whoami) No.#I-#P]#[default]'
set -g status-left-length 20
## 右部:[2011/03/06(Sun)20:21]
set -g status-right '| #[fg=black,bold]#(echo $LANG)#[default] | #[fg=magenta]load avg (#(~/dotfiles/bin/loadaverage))#[default] | #[fg=cyan]Mem #(~/dotfiles/bin/used-mem)#[default] | #[fg=red,bold]%y/%m/%d(%a)%H:%M:%S#[default] '
# Rightの表示領域最大長
set -g status-right-length 150



# ------------ bind ------------------

# ペインリサイズはC-h/l/j/k
# (-r で連続でOK)
bind -r C-h resize-pane -L 5
bind -r C-l resize-pane -R 5
bind -r C-j resize-pane -D 5
bind -r C-k resize-pane -U 5

# ペイン移動はC-h/l/j/k
# (-r で連続でOK)
bind -r h select-pane -L
bind -r l select-pane -R
bind -r j select-pane -D
bind -r k select-pane -U

# Smart pane switching with awareness of vim splits
# bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)g?(view|n?vim?)(diff)?$' && tmux send-keys C-h) || tmux select-pane -L"
# bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)g?(view|n?vim?)(diff)?$' && tmux send-keys C-j) || tmux select-pane -D"
# bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)g?(view|n?vim?)(diff)?$' && tmux send-keys C-k) || tmux select-pane -U"
# bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)g?(view|n?vim?)(diff)?$' && tmux send-keys C-l) || tmux select-pane -R"
# bind -n C-\ run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)g?(view|n?vim?)(diff)?$' && tmux send-keys 'C-\\') || tmux select-pane -l"

# ------------ bind(copy mode) ---------

#コピーモードに入る
bind-key C-y copy-mode

# vでマーク開始, yでヤンク, pでペースト
bind -t vi-copy v begin-selection
bind -t vi-copy y copy-selection
bind-key C-p paste-buffer

# ------------ tmux-powerline ---------

# tmuxのステータスバーをon  
set-option -g status on  
# ステータスバーに更新をかける感覚[s]  
set-option -g status-interval 2  
# utf-8で表示（デフォルトはoff）  
set-option -g status-utf8 on  
# ウィンドウ一覧をどうならべるか設定("left","centre","right")  
set-option -g status-justify "left"  
# ウィンドウ一覧の左側に出すステータスバーの長さ（表示がつぶれないように長さを変える）  
set-option -g status-left-length 100  
# ウィンドウ一覧の右側に出すステータスバーの長さ  
set-option -g status-right-length 120  
# powerlineによるステータスバーを有効にする（~/path/to/ => ~/.tmux/)  
set-option -g status-left "#(~/tmux-powerline/powerline.sh left)"  
set-option -g status-right "#(~/tmux-powerline/powerline.sh right)"  

#####set -g message-attr bold
#####set -g message-fg white
#####set -g message-bg red
#####
#####set -g pane-active-border-fg white
#####set -g pane-active-border-bg black
#####
#####set-window-option -g mode-bg white
#####set-window-option -g mode-fg black
#####set-window-option -g window-status-bg black
#####set-window-option -g window-status-fg white
#####set-window-option -g window-status-current-bg black
#####set-window-option -g window-status-current-fg green
#####set-window-option -g window-status-current-attr bold

# Set the prefix to ^T.
# unbind C-b
set -g prefix ^T
# set-option -g prefix C-t
# bind t send-prefix

# config reload
# unbind r
# bind r source-file ~/.tmux.conf; display-message "Reload Config!!"


# window
## windowの移動
#bind -r h next-window
#bind -r l next-window

#
# pane
## pane - 縦分割
# unbind v
# bind v split-window -h
## pane - 横分割
# unbind s
# bind s split-window -v
## pane - ペイン間の移動
# unbind h
# unbind j
# unbind k
# unbind l
# bind -r h select-pane -L
# bind -r j select-pane -D
# bind -r k select-pane -U
# bind -r l select-pane -R
## pane - ペインのリサイズ
# unbind H
# unbind J
# unbind K
# unbind L
# bind -r H resize-pane -L 5
# bind -r J resize-pane -D 5
# bind -r K resize-pane -U 5
# bind -r L resize-pane -R 5

### ------------ bind(copy mode) ---------
# TODO: ペーストがwindowの移動のバインドとかぶってる
##コピーモードに入る
#bind-key C-y copy-mode
## vでマーク開始, yでヤンク, pでペースト
#bind -t vi-copy v begin-selection
#bind -t vi-copy y copy-selection
#bind-key C-p paste-buffer
## vi-style controls for copy mode
#setw -g mode-keys vi


## Bind appropriate commands similar to screen.
## lockscreen ^X x
## unbind ^X
## bind ^X lock-server
## unbind x
## bind x lock-server
#
## screen ^C c
#unbind ^C
#bind ^C new-window -n zsh
#bind c new-window -n zsh
#
## detach ^D d
#unbind ^D
#bind ^D detach
#
## displays *
#unbind *
#bind * list-clients
#
## next ^@ ^N sp n
#unbind ^@
#bind ^@ next-window
#unbind ^N
#bind ^N next-window
#unbind " "
#bind " " next-window
#unbind n
#bind n next-window
#
## title A
#unbind A
#bind A command-prompt "rename-window %%"
#
## copy-mode ^[
#unbind ^"["
#bind -r ^"[" copy-mode
#unbind ^]
#bind -r ^] paste-buffer
#
## other ^A
#unbind ^A
#bind ^A last-window
#
## prev ^H ^P p ^?
#unbind BSpace
#bind BSpace previous-window
#
## windows ^W w
#unbind ^W
#bind ^W list-windows
#unbind w
#bind w list-windows
#
## quit \
#unbind \
#bind \ confirm-before "kill-server"
#
## kill K k
#unbind K
#bind K confirm-before "kill-window"
#unbind k
#bind k confirm-before "kill-window"
#
## redisplay ^R r
#unbind ^R
#bind ^R refresh-client
#unbind r
#bind r refresh-client
#
## split -v |
#unbind |
#bind | split-window
#
## :kB: focus up
#unbind Tab
#bind Tab select-pane -t :.-
#unbind BTab
#bind BTab select-pane -t :.+
#unbind ^H
#bind ^H select-pane -t :.-
#unbind h
#bind ^h select-pane -t :.-
#unbind ^L
#bind ^L select-pane -t :.+
#unbind l
#bind l select-pane -t :.+
#
## " windowlist -b
#unbind '"'
#bind '"' choose-window

# zshでpbcopy
# set-option -g default-command "reattach-to-user-namespace -l zsh"

